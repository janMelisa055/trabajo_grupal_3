---
fontsize: 12pt
linestretch: 1.5
header-includes:
  - \usepackage[document]{ragged2e}
output: 
  pdf_document: 
    latex_engine: xelatex

---

```{r setup, include = FALSE}
setwd("C:/Users/oienh/Documents/R_UNIVERSITY_PROJECTS/5th_Semester/trabajo_grupal_3")
knitr::opts_chunk$set(echo = FALSE, comment = NA)
library(readxl)
library(FinCal)
library(FinancialMath)
library(gt)
```

```{r, echo=FALSE, fig.align = "left"}
knitr::include_graphics("logo.png")
```

\center

# Trabajo Grupal 3
## 2023-05-20/2023-05-25

```{r, echo=FALSE, fig.align = "center"}
knitr::include_graphics("coat_of_arms.png")
```

* Amanda Araya Orrego
* Lucas Oliva Valverde
* Melissa Sumi Ibata
* Exequiel Valdés Zúñiga

\newpage
\justifying


```{r}
balance <- read_excel("balance_amzn.xlsx")
inversion <- as.numeric((0.1 * balance[1, 2]) / 1000)
r <- read_excel("wacc.xls",
  range = "A19:L115", sheet = "Industry Averages")
r <- as.numeric(r[75, 11])

# Datos a utilizar.
```

```{r}
dinero_millones <- function(x) {
    ifelse(round(x, 2) != 0,
      paste0("$", format(round(x, 2), big.mark = "\u202f", scientific = FALSE,
    decimal.mark = ","), "M"),
    "$ -")
}
# Formato de dinero en millones para añadir separadores de miles,
# coma decimal, y dos puntos decimales.

porcien <- function(x) {
    paste0(format(round(x * 100, 2), scientific = FALSE,
    decimal.mark = ","), "%")
}
# Formato para porcentajes en estilo SI francés (coma decimal).
```
# Introducción

# Flujos

```{r}
flujo <- rep(75294 * 0.1, 15)
flujos <- c(-inversion, flujo)
cat(paste0("Los flujos durante 15 años es de ",
dinero_millones(as.numeric(flujo[1])), ".\n",
"La inversión es de ", dinero_millones(inversion), "."))
```

# VP

```{r}
i <- 1:15
VP <- sum(flujo[i] / (1 + r)^i)

cat(paste0("El valor presente es de ", dinero_millones(VP), "."))
```

# VAN

```{r}
VAN <- npv(r, flujos)

cat(paste0("El VAN es de ", dinero_millones(VAN), ".\n",
"La viabilidad del proyecto es ", VAN > 0, "."))
```

# TIR

```{r}
TIR <- irr(flujos)

cat(paste0("La TIR es de ", porcien(TIR), ".\n",
"La viabilidad del proyecto es ", TIR > r, "."))
```
